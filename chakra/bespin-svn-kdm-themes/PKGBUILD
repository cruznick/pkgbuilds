# Maintainer Benjamin Mtz (cruznick) <cruznick at archlinux dot us>


#pkgbase=bespin-svn
pkgname=bespin-svn-kdm-themes
#pkgname=('bespin-svn' 'bespin-svn-kdm-themes' 'bespin-svn-ksplash-themes ' 'bespin-black-icons')
pkgver=1264
pkgrel=1
pkgdesc="Qt4/KDE4 style"
arch=(i686 x86_64)
url="http://kde-look.org/content/show.php/Bespin?content=63928"
license=('LGPL')
depends=('qt' 'kdelibs')
optdepends=('kdebase-workspace')
makedepends=('cmake>=2.4' 'automoc4' 'subversion' 'kdebase-workspace')
provides=('bespin')
changelog=bespin-svn.changelog

_svntrunk="https://cloudcity.svn.sourceforge.net/svnroot/cloudcity"
_svnmod="bespin"

build() {
  cd ${srcdir}

  if [[ -d ${_svnmod}/.svn ]]; then
     (cd ${_svnmod} && svn up -r $pkgver)
  else
     svn co ${_svntrunk} --config-dir ./ -r ${pkgver} ${_svnmod}
  fi

  msg "SVN checkout done or server timeout"
  msg "Starting make..."

  rm -rf ${srcdir}/${_svnmod}-build
  cp -r ${srcdir}/${_svnmod} ${srcdir}/${_svnmod}-build
}
 
package_bespin-svn(){
  cd ${srcdir}/${_svnmod}-build

  cmake -DCMAKE_INSTALL_PREFIX=`kde4-config --prefix` -DENABLE_ARGB=ON \
        -DCMAKE_BUILD_TYPE=Release || return 1
  make || return 1
  make DESTDIR=${pkgdir} install || return 1

  install -D ${srcdir}/${_svnmod}-build/man/bespin.1 ${pkgdir}/usr/share/man/man1/bespin.1
  install -D ${srcdir}/${_svnmod}-build/extras/bespin-compl ${pkgdir}/etc/bash_completion.d/bespin

}

package_bespin-svn-kdm-themes(){
pkgdesc="Bespin/tibanna Kdm Themes"
  mkdir -p $pkgdir/usr/share/apps/kdm/themes/Bespin
  cp -r $srcdir/$_svnmod-build/kdm/* $pkgdir/usr/share/apps/kdm/themes/Bespin/
  mv $pkgdir/usr/share/apps/kdm/themes/Bespin/tibanna $pkgdir/usr/share/apps/kdm/themes/
}

package_bespin-svn-ksplash-themes(){
pkgdesc="Bespin/Tibanna ksplash themes"
depends=liblqr
cd $srcdir/$_svnmod-build/ksplash

   #4:3
   ./generate.sh 640 480
   ./generate.sh 800 600
   ./generate.sh 1024 768
   ./generate.sh 1280 960
   ./generate.sh 1400 1050
   ./generate.sh 1600 1200
   
   #16:9
   ./generate.sh 1280 720
   ./generate.sh 1365 768
   ./generate.sh 1600 900
   ./generate.sh 1920 1080    

   #16:10
   ./generate.sh 1280 800
   ./generate.sh 1440 900
   ./generate.sh 1680 1050
   ./generate.sh 1920 1200

   cd $srcdir/$_svnmod-build/ksplash/tibanna
   #4:3
   ./generate.sh 640 480
   ./generate.sh 800 600
   ./generate.sh 1024 768
   ./generate.sh 1280 960
   ./generate.sh 1400 1050
   ./generate.sh 1600 1200

   #16:9
   ./generate.sh 1280 720
   ./generate.sh 1365 768
   ./generate.sh 1600 900
   ./generate.sh 1920 1080

   #16:10
   ./generate.sh 1280 800
   ./generate.sh 1440 900 
   ./generate.sh 1680 1050
   ./generate.sh 1920 1200

   mkdir -p $pkgdir/usr/share/apps/ksplash/Themes/Bespin
   cp -r $srcdir/$_svnmod-build/ksplash/* $pkgdir/usr/share/apps/ksplash/Themes/Bespin/
   mv $pkgdir/usr/share/apps/ksplash/Themes/Bespin/tibanna $pkgdir/usr/share/apps/ksplash/Themes/
}

package_bespin-black-icons(){
#depens=(inkscape) 
#_color=black
#_basename=bespin


# install -d $pkgdir/usr/share/icons/
#  cd $srcdir/$_svnmod-build/icons/
#  echo "basename=$_basename" >> config
#  echo "color=$_color" >> config
#  echo "halo=white" >> config
#  echo "alpha=85" >> config
#  echo "" >> config
#  ./generate_kde_icons.sh
#  cp -r $srcdir/$_svnmod-build/icons/$_basename-$_color $pkgdir/usr/share/icons/
###If you dont want to install inkscape in your sistem you can use this option
   cd $srcdir
   wget http://dl.dropbox.com/u/11529444/chakra/Bespin-Black.tar.gz
   tar -xvf Bespin-Black.tar.gz
    install -d $pkgdir/usr/share/icons/Bespin-Black
 # Install the data
     cp -r $srcdir/Bespin-Black/* $pkgdir/usr/share/icons/Bespin-Black

}
